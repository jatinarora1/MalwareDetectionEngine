#!/usr/bin/python

import sys
from MalwareSampleReport import MalwareSampleReport

inReportName = sys.argv[1]
outReportName = sys.argv[2]

sigType = sys.argv[3]
sigDesc = sys.argv[4]
sigSeverity = sys.argv[5]
sigValue = None
if len(sys.argv) > 6:
    sigValue = float(sys.argv[6])

sample = MalwareSampleReport(inReportName)


sig = dict()

sig["families"] = list()
sig["description"] = sigDesc
sig["severity"] = int(sigSeverity)
sig["marks"] = list()
sig["references"] = list()
sig["name"] = sigType
if sigValue is not None:
    sig["value"] = sigValue


sample.add_signature(sig)


sample.dump_json_file(outReportName)
