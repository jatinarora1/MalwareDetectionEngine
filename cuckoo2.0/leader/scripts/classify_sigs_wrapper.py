#!/usr/bin/python

import SignatureClassifier
import json
import sys


if __name__ == "__main__":
	try:
		report_file = sys.argv[1]
		cuckoo_base = sys.argv[2]
		outfile = sys.argv[3]
	except IndexError:
		print "Please provide the arguments as follows: <report> <cuckoo base folder> <output report>"
		exit (-1)
	
	f = open(report_file)
	
	report = json.load(f)
	
	classifier = SignatureClassifier.SignatureClassifier(report, cuckoo_base)
	
	classifier.classify_sigs()
	
	classifier.dump_json(outfile)
	



