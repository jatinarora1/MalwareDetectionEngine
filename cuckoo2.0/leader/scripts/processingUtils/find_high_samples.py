import sys

sys.path.append("../")
from MalwareSampleReport import MalwareSampleReport

#List of samples
inFile = sys.argv[1]


#Read list of samples
lines = [line.rstrip('\n') for line in open(inFile)]


origFileName = "origCuckoo.json"
newFileName = "dvasionCuckoo.json"

for line in lines:
	name = line
	origJsonFile = name + "/" + origFileName
	newJsonFile = name + "/" + newFileName

	try:
		origReport = MalwareSampleReport(origJsonFile)
		newReport = MalwareSampleReport(newJsonFile)

		origScore = origReport.get_score()
		newScore  = newReport.get_score()
		diff = newScore - origScore

		print name, str(origScore), str(newScore), str(diff)
	except:
		print "Failed binary: " + name
	


