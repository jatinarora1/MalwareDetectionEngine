#!/usr/bin/python

#A utility to categorize a list of reports in score bucket. It takes a file
#containig the list of files that we want to process


import sys
sys.path.append("../")

from MalwareSampleReport import MalwareSampleReport


origBucket=[0,0,0,0]

def updateBucket(score,bucket):
	if score < 1.0:
		bucket[0] = bucket[0]+1

	elif score < 2.0:
		bucket[1] = bucket[1]+1

	elif score < 5.0:
		bucket[2] = bucket[2]+1

	else :
		bucket[3] = bucket[3]+1



def GetScore(inFile):
	curReport = MalwareSampleReport(inFile)
	return curReport.get_score()




#List of malware samples
listMalware = sys.argv[1]



with open(listMalware) as f:
	lines = f.readlines()
	lines = [x.strip() for x in lines]
	for sample in lines:
		print "Processing sample " + sample

		try:
			origScore = GetScore(sample)
			print origScore
			updateBucket(origScore,origBucket)
		except:
			print "Failed to read score"

	

#Print buckets
print "Original Bucket"
print origBucket

	

