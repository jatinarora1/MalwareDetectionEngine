#!/usr/bin/python

#This script compares scores in two runs
#It takes three arguments 
#1.List of samples
# 2. First malwareOutput folder 
# 3. Second malwareOutput folder
# It compares the scores between first and second run for each sample. -ve
#implies that score is higher in second run


import sys
from collections import defaultdict

from MalwareSampleReport import MalwareSampleReport


#File containing list of cuckoo reports
listSamples = sys.argv[1]

#First malwareOutput folder
inFolder1 = sys.argv[2]

#Second malwareOutput folder
inFolder2 = sys.argv[3]
netDiff = 0.0


samples = [line.rstrip('\n') for line in open(listSamples)]

#Iterate over the reports
for sample in samples:
	try:
		curFile1 = inFolder1 + "/" + sample + "/dvasionCuckoo.json"
		curFile2 = inFolder2 + "/" + sample + "/dvasionCuckoo.json"
	
		report1 = MalwareSampleReport(curFile1)

		report2 = MalwareSampleReport(curFile2)


		score1 = report1.get_score()
		
		score2 = report2.get_score()
		
	
		diff = score1 - score2

		if score1 != score2:	
			print sample + " :  "  + str(diff)
			netDiff = netDiff + diff
		continue
	except:
		print "Failed Sample: " + sample


print netDiff

