<section id="signatures">
    <div class="section-title">
        <h4>Signatures</h4>
	<h5>Signatures marked as NEW are not detected by Cuckoo</h5>
    </div>
    {% if results.signatures %}
        {% for sign in results.signatures %}
        <div>
	    {% if sign.new_vs_cuckoo %}
		<img style="float:left" src='data:image/png;base64,/9j/4AAQSkZJRgABAQEAYABgAAD/2wBDAAMCAgMCAgMDAwMEAwMEBQgFBQQEBQoHBwYIDAoMDAsKCwsNDhIQDQ4RDgsLEBYQERMUFRUVDA8XGBYUGBIUFRT/2wBDAQMEBAUEBQkFBQkUDQsNFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBT/wAARCAAbAEMDASIAAhEBAxEB/8QAHwAAAQUBAQEBAQEAAAAAAAAAAAECAwQFBgcICQoL/8QAtRAAAgEDAwIEAwUFBAQAAAF9AQIDAAQRBRIhMUEGE1FhByJxFDKBkaEII0KxwRVS0fAkM2JyggkKFhcYGRolJicoKSo0NTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uHi4+Tl5ufo6erx8vP09fb3+Pn6/8QAHwEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoL/8QAtREAAgECBAQDBAcFBAQAAQJ3AAECAxEEBSExBhJBUQdhcRMiMoEIFEKRobHBCSMzUvAVYnLRChYkNOEl8RcYGRomJygpKjU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6goOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4uPk5ebn6Onq8vP09fb3+Pn6/9oADAMBAAIRAxEAPwD60+G918Yf2g/CsfjrSfiha+BNF1O4uBYaPbeHLe+McMczxAvLKwYuShzjjvxnA6f/AIVB8bv+jgv/ACy7H/4uj9hn/k1nwT/2/f8ApdcV7xXl4ehGrRhUnKV2k370uq8meticRKjXnThGNotpe7F7PzVzwf8A4VB8bv8Ao4L/AMsux/8Ai6P+FQfG7/o4L/yy7H/4ur/7Xmkw698FbnTLksLa91XTLaXYcNte9hU4Prg18v8Aj7UNbWx+IXhjxUQ+s+F/C1npE19Mn7u9hXVInguMZ6PE6bhnqG6VzVnTpTcGpdbe/LW0XJ9dOn3t9Drw8aleEZpx1aT9yGl2lfbXf8u+n0j/AMKg+N3/AEcF/wCWXY//ABdH/CoPjd/0cF/5Zdj/APF15f441bw/8I9B8K/EvwpeeD9VTR7y803UJPA9jHa2rC5tf3ayRRzSguJYockv0YcDFZ3wV8N6hpPxC8MfCLVpZ7o+HdTPjCeWRAQ6NZRlASR2uriT1+59DVQ9nKp7P3ui+OW7s9NdbRvL/t23mJ+09n7ROOzf8OPS9+mmvKv+3kew/wDCoPjd/wBHBf8All2P/wAXR/wqH43jkftABj6HwZZAH/x+veKK7/qtPvL/AMCl/meZ9cqdo/8AgEP/AJE+GZv+Cgmr/D2+v/C/inQbbWvEGi3lxp15qFnIYYrh4pnj3qmDjIUfjngdAV8h/Hz/AJLr8Rv+xk1L/wBKpKK+HnmuLpycFPReh9/TyjBVIKcoavXdn6I+Efhb8bfg1pB8LeAtT8B6n4RtbiaXTj4kivEu4Y5JGkMbeT8rYZ256nPboNn/AIyc/wCqS/8AlTr3iivt1hYxXLGUkl5nwUsZKT5pQi2+tjwf/jJz/qkv/lTo/wCMnP8Aqkv/AJU694op/Vv78vvJ+tf9O4/ceD/8ZOf9Ul/8qdH/ABk5/wBUl/8AKnXvFFH1b+/L7w+tf9O4/ceD/wDGTn/VJf8Ayp0f8ZOHjPwmHuP7TyK94oo+rf35feH1r/p3H7j5Ltv+CfuheIvP1fxlrtxf+KtRuJr3UrjT0WO3aaWRpG2KwyAN2OeuM4HSivrSisf7OwnWmjf+08Z0qNH/2Q==' />
	    {% endif %}
            {% if sign.severity == 1 %}
                <div style="margin-left: 70px" class="alert alert-success signature">
            {% elif sign.severity == 2 %}
                <div style="margin-left: 70px" class="alert alert-warning signature">
            {% elif sign.severity >= 3 %}
                <div style="margin-left: 70px" class="alert alert-error signature">
            {% else %}
                <div style="margin-left: 70px" class="alert alert-info signature">
            {% endif %}
            <b>{{sign.description}}<a href="javascript:showHide('signature_{{sign.name}}');">  details</a></b>
            <div id="signature_{{sign.name}}" style="display: none;" >
            {% if sign.marks and sign.marks.length!=0 %}
	    <table class="table table-striped table-bordered">
              {% if sign.marks[0].type == "ioc" %}
               <thead>
               <tr>
                   <th>Type</th>
                   <th>Info</th>
              </tr>
              </thead>
	       {% for mark in sign.marks %}
                <tbody>
                 <tr>
                  <td>{{mark.category}}</td>
                  <td>{{mark.ioc}}</td>
                 </tr>
                </tbody>
                {% endfor %}

              {% elif sign.marks[0].type == "call" %}
               <thead>
               <tr>
                   <th>PID</th>
                   <th>API</th>
		   <th>Arguments</th>
              </tr>
              </thead>
	       {% for mark in sign.marks %}
                <tbody>
                 <tr>
		  {% if mark.pid %}
                  <td>{{mark.pid}}</td>
		  {% else %}
		  <td>N/A</td>
		  {% endif %}
		  
		  {% if mark.call and mark.call.api %}
                  <td><span class="mono">{{mark.call.api}}</span></td>
		  {% else %}
		  <td>N/A</td>
		  {% endif %}

		
		  {% if mark.call and mark.call.arguments %}
		  <td style="word-wrap: break-word">
                      {% for key, value in mark.call.arguments.items() %}
                           {{key}} => <span class="mono">{{value}}</span><br />
                      {% endfor %}
                   </td>	
		  {% else %}
		  <td>N/A</td>
		  {% endif %}

                 </tr>
                </tbody>
                {% endfor %}
		
		{% endif %}
               </table>
            {% endif %}
            </div>
            </div>
        </div>
        {% endfor %}
    {% else %}
        No signatures matched
    {% endif %}
</section>
